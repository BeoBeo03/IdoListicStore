<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DetailAlbum</title>
    <link rel="stylesheet" href="./css/Detail.css">
    <link rel="stylesheet" href="./css/Home.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css">
</head>

<body>
    <div class="header">
        <div class="header_content">
            <a class="header_content_logo" href="./index.html">
                <img src="./img/logo.png" alt="">
            </a>
            <div style="width: 130px; height: 100%" class="header_content_category">
                <a href="" class="header_content_list">
                    <span>S·∫£n ph·∫©m</span>
                    <i class="fa-solid fa-caret-down"></i>
                </a>
                <div style="height: 150px;" class="header_content_product">
                    <a href="./MenuAlbum.html">

                        <span>Album</span>
                    </a>
                    <a href="./MenuLightStick.html">

                        <span>Lightstick</span>
                    </a>
                    <a href="./MenuMerchandise.html">

                        <span>Merchandise</span>
                    </a>

                </div>
            </div>
            <div class="header_content_items">
                <a href="./Cart.html">
                    <i class="fa-solid fa-cart-shopping"></i>
                    <span>Gi·ªè h√†ng</span>
                </a>
            </div>

        </div>
    </div>

    <div class="home">
        <!-- mapping album -->
        <div class="mapping_page"><a href="./index.html">Home</a> / <a href="./MenuAlbum.html">Album</a> / DETAIL
        </div>
        <!-- product -->
        <div class="product">
            <div class="pd_img">
                <!-- render img -->
                <img src="" alt="">
            </div>
            <div class="pd_detail">
                <!-- render title -->
                <h1 style="line-height: 1.4;"></h1>
                <span class="pd_sku">
                    <strong>M√£ s·∫£n ph·∫©m: </strong>
                    "ƒêang c·∫≠p nh·∫≠t"
                </span>
                <div class="pd_detail_content">
                    <p style="width: 200px;margin-top: 18px;"></p>
                    <div class="pd_detail_content_left">
                        <!-- render price -->
                        <p></p>
                        <!-- render id to quantity-->
                    </div>
                    <div class="pd_detail_content_right">
                        <h2>D·ªãch v·ª• c·ªßa ch√∫ng t√¥i</h2>
                        <div class="content">
                            <i class="fa-solid fa-truck-fast"
                                style="display: inline-block; font-size: 20px;padding: 10px 10px 0 0;"></i>
                            <div class="content_p">
                                <p>Giao h√†ng to√†n qu·ªëc qua c√°c ƒë∆°n v·ªã v·∫≠n chuy·ªÉn <span>H√ÄNG TI·∫æT KI·ªÜM</span>, <span>GIAO
                                        H√ÄNG NHANH</span>, <span>Viettel post</span></p>
                                <p>Giao h√†ng n·ªôi th√†nh S√ÄI G√íN - H·ªèa t·ªëc trong ng√†y</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- add cart -->
                <button onclick="addItem()" id="add">Th√™m v√†o gi·ªè h√†ng</button>
                <h2>Xin ƒë·ª´ng b·ªè qua</h2>
                <ul>
                    <li>Album Ch√≠nh h√£ng - nguy√™n seal</li>
                    <li>Nh·∫≠p tr·ª±c ti·∫øp t·ª´ ph√¢n ph·ªëi uy t√≠n H√†n Qu·ªëc</li>
                    <li>Album ƒë∆∞·ª£c t√≠nh ƒëi·ªÉm b·∫£ng x·∫øp h·∫°ng Hanteo v√† Gaon.</li>
                </ul>
            </div>
        </div>

        <!-- chi ti·∫øt n·ªôi dung-->
        <div class="description">
            <h2>m√¥ t·∫£ s·∫£n ph·∫©m</h2>
            <div class="description_content">
                <!-- render title -->
                <h1 style="color: #CD7FC7;"></h1>
                <h3 style="color: #F70A8D; margin: 0 0 20px 0;"><i class="fa-solid fa-circle-exclamation"
                        style="margin-right: 10px;"></i>Album detail</h3>
                <!-- render cointent -->
                <div class="list"></div>
            </div>
        </div>

        <!-- chi ti·∫øt h√¨nh ·∫£nh -->
        <div class="description">
            <h2>chi ti·∫øt s·∫£n ph·∫©m</h2>
            <div class="description_img">
                <!-- render img description -->
                <img src="" alt="">
            </div>
        </div>
        <!-- s·∫£n ph·∫©m li√™n quan -->
        <div class="description">
            <h2>s·∫£n ph·∫©m li√™n quan</h2>
            <div class="related">
                <div class="content_menu_max_list"></div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="footer_container">
            <div class="footer_container_brand">
                <div class="footer_logo">
                    <a href="./index.html">
                        <img src="./img/logo.png" alt="">
                    </a>
                    <div class="footer_logo_internet">
                        <a href="https://www.facebook.com/profile.php?id=100009418012261&locale=vi_VN"><i class="fa-brands fa-facebook"></i></a>
                        <a href="https://www.instagram.com/_caniburweaknd_/"><i class="fa-brands fa-instagram"></i></a>
                        
                    </div>
                </div>
                <div class="footer_list">
                    <div class="footer_list_heading"><a style="color: #eb2aab; margin-top: 0; text-decoration: none;" href="./MenuAlbum.html">ALBUM</a></div>
                    <p href="">
                        Photobook ver
                    </p>
                    <p href="">
                        QR ver
                    </p>
                    <p href="">
                        Standard ver
                    </p>
                </div>
                <div class="footer_list">
                    <div class="footer_list_heading"><a style="color: #eb2aab; margin-top: 0; text-decoration: none;" href="./MenuLightStick.html">LIGHTSTICK</a></div>
                    <p href="">
                        LightStick
                    </p>
                    <p href="">
                        Light Ring
                    </p>
                </div>
                <div class="footer_list">
                    <div class="footer_list_heading"><a style="color: #eb2aab; margin-top: 0; text-decoration: none;" href="./MenuMerchandise.html">MERCHANDISE</a></div>
                    <p href="">
                        Card bo g√≥c
                    </p>
                    <p href="">
                        ƒê·ªì trang tr√≠
                    </p>
                    <p href="">
                        S·∫£n ph·∫©m kh√°c
                    </p>
                </div>
            </div>
            <div class="footer_line">

            </div>
            <div class="footer_copyright">
                ¬©2024 IDOLISTIC International Corp. All Rights Reserved. 
            </div>
            <div class="footer_contact">
                Li√™n h·ªá: uel@gmail.com
            </div>
        </div>
    </div>
    <section id="btnSection" style="position: fixed;z-index: 1;bottom: 2em;right: 2em;">
        <div class="contact tooltip-container">
            <button class="text"  style="width: 180px;height: 60px;border: none;background-color: #ed3fb3;border-radius: 10px;font-size: 24px;cursor: pointer;color: white;" ><i style="font-size: 24px;margin-right: 5px;" class="fa-regular fa-comment"></i> Li√™n h·ªá</button>
            <span class="tooltip">Click Me</span>
            
            <span>Hello! üëã</span>
        </div>
        <div class="overlay"></div>
        <div class="contact_items">
            
           <a  href="tel:0984858917">
            <div class="contact_item"><img src="./img/icon_phone3.jpg" alt=""><span>0984858917</span></div>
           </a>
           <a  href="https://zalo.me/0984858917">
            <div class="contact_item"><img src="./img/icon_zl.jpg" alt=""><span>0984 85 89 17</span></div>
           </a>
           <a  href="https://www.facebook.com/profile.php?id=100009418012261&locale=vi_VN">
            <div class="contact_item"><img src="./img/icon_fb.png" alt=""><span>Facebook</span></div>
           </a>
        </div>
    </section>
    <script>
        const btnsection = document.querySelector("#btnSection");
        const btncontact = document.querySelector(".contact_items");
        btnsection.addEventListener("click",() =>{
            btncontact.classList.add("active");
            setTimeout(() => {
                btncontact.classList.remove("active")
            },5000);
        })
        // 

        const $ = document.querySelector.bind(document)
        const $$ = document.querySelectorAll.bind(document)
        let cart = JSON.parse(localStorage.getItem("CART")) || [];

        const list = {
            items: [
            {
                    id: "album_01",
                    title: "ALBUM TEAYONG - TAP FLIP ZINE",
                    img: "./img/IMG_ALBUM/01_teayong.png",
                    price: 280000,
                    content: null,
                    imgDescription: "./img/IMG_ALBUM/01_teayong_dt.png"
                },
                {
                    id: "album_02",
                    title: "ALBUM IU - LOVE POEM",
                    img: "./img/IMG_ALBUM/02_lovePoem.png",
                    price: 380000,
                    content: [
                        "Disc: 1",
                        "Size: 140 * 190 * 12(mm)",
                        "Photo cart: Random 1p out of 2p",
                        "Bookmark: Random 1p out of 2p",
                        "Poster: 1p(For the First press only)"
                    ],
                    imgDescription: "./img/IMG_ALBUM/02_lovePoem_dt.png"
                },
                {
                    id: "album_03",
                    title: "ALBUM IU - PALETTE",
                    img: "./img/IMG_ALBUM/03_palette.png",
                    price: 420000,
                    content: null,
                    imgDescription: "./img/IMG_ALBUM/03_palette_dt.png"
                },
                {
                    id: "album_04",
                    title: "ALBUM IU - THE WINNING",
                    img: "./img/IMG_ALBUM/04_theWinning.png",
                    price: 490000,
                    content: [
                        "SLEEVE: 176.5*242*19.5(mm)",
                        "PHOTOBOOK: 172*242*17(mm) / 148p",
                        "DISC 1: 120*120(mm)",
                        "AccordionPhotoCart: 99 * 107(mm) / spread 528* 107(mm) / 1EA(Image varies by version)",
                        "MUGSHOT PHOTO CARt: 100 * 148(mm) / 1EA(Image varies by version)",
                        "CROSSWORD PUZZLE POSTCARt: 120 * 120(mm) / 1EA(Image varies by version)",
                        "LOGO STICKER: 3EA(Image varies by version)",
                        "HIDDEN MESSAGE CARt: 128 * 182(mm) / 1EA(Image varies by version)",
                        "PHOTO CARt: 55 * 85(mm) / 3EA(Image varies by version)"
                    ],
                    imgDescription: "./img/IMG_ALBUM/04_theWinning_dt.png"
                },
                {
                    id: "album_05",
                    title: "ALBUM LISA (BLACKPINK) - LALISA",
                    img: "./img/IMG_ALBUM/05_lisa.png",
                    price: 430000,
                    content: [
                        "PACKAGE BOX : 177 x 257 x 34 (mm)",
                        "PHOTOBOOK : 167 x 247(mm) / 88P",
                        "LYRICS PAPAER : 140 x 195(mm) / 1EA",
                        "RANDOM PHOTOCARt : Random 1p out of 4p",
                        "RANDOM POLAROID : Random 1p out of 4p",
                        "DOUBLE - SIDED POSTER : 1EA",
                        "RANDOM RARE GOLD PHOTOCARt : Random 1p out of 4p(First Press Only)",
                        "RARE GOLD TICKET : 1EA / ONLY 50EA(Randomly included only in some quantities of first press albums / not included in all first press)"
                    ],
                    imgDescription: "./img/IMG_ALBUM/05_lisa_dt.png"
                },
                {
                    id: "album_06",
                    title: "ALBUM SEULGI - 28 REASONS PHOTOBOOK VER",
                    img: "./img/IMG_ALBUM/06_seulgi.png",
                    price: 350000,
                    content: [
                        "COVER 1ea",
                        "PHOTOBOOK 64p",
                        "MINI POSTER: Random 1 out of 4",
                        "PHOTOCARt: Random 1 out of 3 (Image varies with Special Ver., Case Ver.)",
                        "FIRST-PRESS ONLY POSTER: Random 1 out of 2"
                    ],
                    imgDescription: "./img/IMG_ALBUM/06_seulgi_dt.png"
                },
                {
                    id: "album_07",
                    title: "ALBUM TEMPEST - TEMPEST VOYAGE",
                    img: "./img/IMG_ALBUM/07_tempest.png",
                    price: 270000,
                    content: [
                        "PACKAGE 152 x 214 x 20 mm",
                        "PHOTO BOOK 150 x 200 mm / 1EA / 84p / Partly Thermochromic Printed on Cover",
                        "LYRIC BOOK 110 x 145 mm / 32p",
                        "CD-R 125 x 125 mm",
                        "POSTCARt 150 x 210 mm / 21EA with Members' Handwritten Messages on the Back",
                        "PHOTO CARt (unit) 55 x 85 mm / Random 1 out of 3",
                        "PHOTO CARt (unit) 55 x 85 mm / Random 1 out of 14",
                        "PRINTED POLAROID 100 x 125 mm / Random 1 out of 7",
                        "STICKER 150 x 100 mm / 1EA",
                        "PHOTO FILM (SAIL VER. ONLY) 85 x 45 mm / Random 1 out of 7",
                        "FOLDED POSTER 300 x 210 mm"

                    ],
                    imgDescription: "./img/IMG_ALBUM/07_tempest_dt.png"
                },
                {
                    id: "album_08",
                    title: "ALBUM TWICE - WITH YOU-TH",
                    img: "./img/IMG_ALBUM/08_twice.png",
                    price: 380000,
                    content: [
                        "PHOTOBOOK 3 TYPES",
                        "PHOTOCARt (RANDOM 5 OUT OF 45)",
                        "CD-R 3 TYPE",
                        "LETTER POSTER (RANDOM 1 OUT OF 9)",
                        "3-CUT PHOTO (RANDOM 1 OUT OF 3)",
                        "STICKER 3EA",
                        "FLIM PHOTOCARt (RANDOM 1 OUT OF 9)",
                        "ENVELOPE 1 TYPE"
                    ],
                    imgDescription: "./img/IMG_ALBUM/08_twice_dt.png"
                },
                {
                    id: "album_09",
                    title: "ALBUM WENDY - WISH YOU HELL",
                    img: "./img/IMG_ALBUM/09_wendy.png",
                    price: 320000,
                    content: null,
                    imgDescription: "./img/IMG_ALBUM/09_wendy_dt.png"
                },
                {
                    id: "album_10",
                    title: "ALBUM XIKERS [HOUSE OF TRICKY : HOW TO PLAY]",
                    img: "./img/IMG_ALBUM/10_xikers.png",
                    price: 280000,
                    content: [
                        "OUT BOX : 185*180 / 1ea (Image varies by version)",
                        "FOLDED POSTER : 340*510 / 1ea (Image varies by version)",
                        "PHOTOBOOK : 170*170 / 1ea (Image varies by version)",
                        "HEART POSTCARt : 100*150 / Random 1 out of 9 (Image varies by version)",
                        "DISC PACK : 120*120 / 1ea (Image varies by version)",
                        "MOVING PHOTO : 80*130 / 1ea (Image varies by version)",
                        "WIDE POLAROID : 110*80 / Random 1 out of 20 (Image varies by version)",
                        "PHOTOCARt : 55*85 / Random 2 out of 18 (Image varies by version)",
                        "TUTORIAL BOOK : 58*93 / 1ea (Image varies by version)",
                        "MAGNETIC COIN : 40*40 / 1ea (Image varies by version)"
                    ],
                    imgDescription: "./img/IMG_ALBUM/10_xikers_dt.png"
                },

            ],
            render: function () {
                const htmls = this.items.map(item => {
                    return `
                        <div class="menu_item_single">
                            <a href="./DetailAlbum.html?id=${item.id}">
                                <img src="${item.img}" alt="">
                                <div class="menu_item_name">${item.title}</div>
                            </a>
                        </div>
                    `
                })
                $('.content_menu_max_list').innerHTML = htmls.join('')
            },
            renderRelate: function () {
                const listAlbumRelate = this.items.slice(0, 4).map(item => {
                    return `
                        <div class="menu_item_single">
                            <a href="./DetailAlbum.html?id=${item.id}">
                                <img src="${item.img}" alt="">
                                <div class="menu_item_name">${item.title}</div>
                            </a>
                        </div>
                    `
                })
                $('.description .related .content_menu_max_list').innerHTML = listAlbumRelate.join('')
            },
            showDetail: function () {
                let detail = $('.home');
                let productID = new URLSearchParams(window.location.search).get('id');
                let thisProduct = this.items.find(item => {
                    return item.id == productID
                })
                if (!thisProduct) {
                    window.location.href = "./index.html";
                }
                let search = cart.find((item) => item.id === thisProduct.id) || [];

                detail.querySelector(".product .pd_img img").src = thisProduct.img;
                detail.querySelector(".product .pd_detail h1").innerText = thisProduct.title;
                
                const formattedPrice = thisProduct.price.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' });
                detail.querySelector(".product .pd_detail .pd_detail_content p").innerText = formattedPrice;
                detail.querySelector(".description .description_content h1").innerText = thisProduct.title;
                if (thisProduct.content) {
                    for (let i in thisProduct.content) {
                        detail.querySelector(".description .description_content .list").innerText += (thisProduct.content[i] + "\n");
                    }
                }
                
                detail.querySelector(".description .description_img img").src = thisProduct.imgDescription;
                detail.querySelector(".pd_detail_content_left").innerHTML =`
                        <div class="buttons">
                            <i onclick="decrementItem(${thisProduct.id})" class="fa-solid fa-minus"></i>
                            <div id="${thisProduct.id}" class="quantity">${search.item === undefined ? 0 : search.item}</div>
                            <i onclick="incrementItem(${thisProduct.id})" class="fa-solid fa-plus"></i>
                        </div>
                `;
            },
            start: function () {
                this.render()
            },
            detail: function () {
                this.renderRelate()
                this.showDetail()
            }
        }
        list.detail()

        // increment
        let incrementItem = (id) => {
            let selectedItem = id;
            let itemInList = list.items.find((product) => product.id === selectedItem.id);
            let search = cart.find((product) => product.id === selectedItem.id);
            if (search === undefined) {
                cart.push({
                    id: selectedItem.id,
                    item: 1,
                    title: itemInList.title,
                    price: itemInList.price,
                    img: itemInList.img
                })
            } else {
                search.item += 1;
            }

            // console.log(cart);
            updateItem(selectedItem.id);
            // localStorage.setItem("CART", JSON.stringify(cart));
        }

        // decrement
        let decrementItem = (id) => {
            let selectedItem = id;
            let itemInList = list.items.find((product) => product.id === selectedItem.id);
            let search = cart.find((product) => product.id === selectedItem.id);
            if(search === undefined) return;
            if (search.item === 0) {
                return;
            } else {
                search.item -= 1;
            }

            // console.log(cart);
            updateItem(selectedItem.id);
            cart = cart.filter((product) => product.item !== 0)

            // localStorage.setItem("CART", JSON.stringify(cart));
        }

        // update
        let updateItem = (id) => {
            let search = cart.find((product) => product.id === id);
            let button = $(".buttons");
            button.querySelector("#" + id).innerHTML = search.item;
        }

        let addItem = () => {
            localStorage.setItem("CART", JSON.stringify(cart));
        }
        let renderCart = () => {
            let cartIcon = document.querySelector(".header_content_items a[href='./Cart.html'] span");
            if (cart.length !== 0) {
                let totalQuantity = cart.reduce((acc, currentValue) => acc + currentValue.item, 0);

                // C·∫≠p nh·∫≠t bi·ªÉu t∆∞·ª£ng gi·ªè h√†ng v·ªõi t·ªïng s·ªë l∆∞·ª£ng
                cartIcon.innerText = totalQuantity;
            }
        }
        renderCart()
    </script>
</body>

</html>